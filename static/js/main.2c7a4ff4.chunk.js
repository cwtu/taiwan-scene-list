(this["webpackJsonptaiwan-scene-searchup"]=this["webpackJsonptaiwan-scene-searchup"]||[]).push([[0],{12:function(e,n,t){},15:function(e,n,t){"use strict";t.r(n);var c=t(2),i=t(6),s=t.n(i),r=(t(12),t(3)),a=t(1),o=[["\u81fa\u5317\u5e02","Taipei"],["\u65b0\u5317\u5e02","NewTaipei"],["\u6843\u5712\u5e02","Taoyuan"],["\u81fa\u4e2d\u5e02","Taichung"],["\u81fa\u5357\u5e02","Tainan"],["\u9ad8\u96c4\u5e02","Kaohsiung"],["\u57fa\u9686\u5e02","Keelung"],["\u65b0\u7af9\u5e02","Hsinchu"],["\u65b0\u7af9\u7e23","HsinchuCounty"],["\u82d7\u6817\u7e23","MiaoliCounty"],["\u5f70\u5316\u7e23","ChanghuaCounty"],["\u5357\u6295\u7e23","NantouCounty"],["\u96f2\u6797\u7e23","YunlinCounty"],["\u5609\u7fa9\u7e23","ChiayiCounty"],["\u5609\u7fa9\u5e02","Chiayi"],["\u5c4f\u6771\u7e23","PingtungCounty"],["\u5b9c\u862d\u7e23","YilanCounty"],["\u82b1\u84ee\u7e23","HualienCounty"],["\u81fa\u6771\u7e23","TaitungCounty"],["\u91d1\u9580\u7e23","KinmenCounty"],["\u6f8e\u6e56\u7e23","PenghuCounty"],["\u9023\u6c5f\u7e23","LienchiangCounty"]];function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t="https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot";return t=t+(e?"/"+e+"?":"?")+"$top=30&$skip="+n+"&$format=JSON"}var d=function(e,n){switch(n.type){case"PREP_FETCH":return Object(a.a)(Object(a.a)({},e),{},{isError:!1,isLoading:!0});case"INI_FETCH":return window.scrollTo(0,0),Object(a.a)(Object(a.a)({},e),{},{scenes:n.newScenes,isLoading:!1});case"CON_FETCH":return Object(a.a)(Object(a.a)({},e),{},{scenes:e.scenes.concat(n.newScenes),isLoading:!1});case"ERR_FETCH":return Object(a.a)(Object(a.a)({},e),{},{isLoading:!1,isError:n.statusText});default:throw new Error("Unhandled action type")}},l=t(0),j=function(e){var n=e.setRequest;return Object(l.jsxs)("div",{id:"navbar",children:[Object(l.jsx)("h1",{id:"title",children:"\u81fa\u7063\u666f\u9ede\u700f\u89bd"}),Object(l.jsxs)("section",{id:"form",children:[Object(l.jsx)("button",{onClick:function(){n(""),document.getElementById("cities").value="\u9078\u64c7\u57ce\u5e02"},children:"\u5168\u90e8"}),Object(l.jsxs)("select",{id:"cities",defaultValue:"\u9078\u64c7\u57ce\u5e02",onChange:function(){var e=document.getElementById("cities");n(e.value)},children:[Object(l.jsx)("option",{disabled:!0,children:"\u9078\u64c7\u57ce\u5e02"},"default"),o.map((function(e){return Object(l.jsx)("option",{value:e[1],onClick:function(){return n(e[1])},children:e[0]},e[1])}))]})]})]})},h=t(7),b=t(5),O=t.n(b),p=Object(c.memo)((function(e){var n=e.ScenicSpotName,t=e.Description,c=e.DescriptionDetail;e.Picture;return t||(t=c),Object(l.jsxs)("li",{className:"scene",children:[Object(l.jsx)("h2",{children:n}),Object(l.jsx)("hr",{}),Object(l.jsx)("p",{className:"description",children:t})]})})),f={scenes:[],isLoading:!1,isError:!1},C=function(e){var n=e.request,t=Object(c.useReducer)(d,f),i=Object(r.a)(t,2),s=i[0],o=i[1];return Object(c.useEffect)((function(){var e=0,t=function(){var n=Object(h.a)(O.a.mark((function n(t){var i,s;return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return window.removeEventListener("scroll",c),o({type:"PREP_FETCH"}),n.next=4,fetch(u(t,e));case 4:return i=n.sent,n.next=7,i.json();case 7:s=n.sent,i.status<400?(o(e?{type:"CON_FETCH",newScenes:s}:{type:"INI_FETCH",newScenes:s}),30===s.length&&window.addEventListener("scroll",c),e+=30):o({type:"ERR_FETCH",statusText:i.statusText});case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),c=function(){Math.round(window.innerHeight+window.scrollY)>=document.body.offsetHeight&&t(n)};return window.addEventListener("scroll",c),t(n),function(){window.removeEventListener("scroll",c)}}),[n]),Object(l.jsx)(l.Fragment,{children:s.isError?Object(l.jsxs)("p",{id:"error",children:["Error: ",s.isError]}):Object(l.jsxs)("ul",{className:"scenelist",children:[s.scenes.map((function(e){return Object(l.jsx)(p,Object(a.a)({},e),e.ID)})),s.isLoading&&Object(l.jsx)("div",{id:"loading",children:"Loading..."})]})})},w=function(){var e=Object(c.useState)(""),n=Object(r.a)(e,2),t=n[0],i=n[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(j,{setRequest:i}),Object(l.jsx)(C,{request:t})]})};s.a.render(Object(l.jsx)(w,{}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.2c7a4ff4.chunk.js.map